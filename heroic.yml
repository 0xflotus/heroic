# vim: sw=2 tabstop=2

port: 8080

cluster:
  useLocal: false
  discovery:
    type: static
    nodes:
      - http://localhost:8080

metrics:
  defaultBackends:
    - heroic
  backends:
    - type: heroic
      group: local
      seeds: localhost:9160
    - type: heroic
      group: heroic
      seeds: &cassandra_lon
        lon3-kairosdbcassandra-a2:9160,lon3-kairosdbcassandra-a3:9160,lon3-kairosdbcassandra-a4:9160
    - type: kairosdb
      group: kairosdb-lon
      seeds: *cassandra_lon
    - type: heroic
      group: heroic
      seeds: &cassandra_sto
        sto3-kairosdbcassandra-a1:9160,sto3-kairosdbcassandra-a2:9160,sto3-kairosdbcassandra-a3:9160
    - type: kairosdb
      group: kairosdb-sto
      seeds: *cassandra_sto
    - type: heroic
      group: heroic
      seeds: &cassandra_sjc
        sjc1-kairosdbcassandra-a1:9160,sjc1-kairosdbcassandra-a2:9160,sjc1-kairosdbcassandra-a3:9160
    - type: kairosdb
      group: kairosdb-sjc
      seeds: *cassandra_sjc
    - type: heroic
      group: heroic
      seeds: &cassahdra_ash
        ash2-kairosdbcassandra-a1:9160,ash2-kairosdbcassandra-a2:9160,ash2-kairosdbcassandra-a3:9160
    - type: kairosdb
      group: kairosdb-ash
      seeds: *cassahdra_ash

metadata:
  backends:
    - type: elasticsearch
      # requires the use of the mapping found in docs/metadata-mapping.json
      nodeClient: false
      clusterName: metalastic-production
      index: meta
      type: meta
      seeds:
        - lon2-heroex-a2.lon2.spotify.net
        - lon2-heroex-a3.lon.spotify.net
        - lon2-heroex-a4.lon2.spotify.net
      writeBulkActions: 2000
      writeBulkFlushInterval: 10000
      concurrentBulkRequests: 5

cache:
  backend:
#    type: in-memory
#    cassandra-cache uses the schema located at "docs/aggregation-schema.cql"
    type: cassandra
    keyspace: aggregations
    seeds: localhost:9160

#consumers:
#  - type: kafka
#    schema: com.spotify.heroic.consumer.schemas.Spotify100
#    topics:
#      - "metrics-lon2"
#      - "metrics-lon3"
#      - "metrics-lon4"
#    config:
#      group.id: heroic
#      zookeeper.connect: lon3-kafkazookeeper-a1.lon3.spotify.net,lon3-kafkazookeeper-a2.lon3.spotify.net,lon3-kafkazookeeper-a3.lon3.spotify.net/kafka-monitoring
#      auto.offset.reset: smallest
#      auto.commit.enable: false
