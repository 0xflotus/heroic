#!/bin/bash

SHARE="/usr/share/heroic"
JAR=$(echo $SHARE/heroic-*.jar)
DEFAULT_JVMARGS="/etc/heroic/heroic.jvmargs"
JVMARGS=${2-$DEFAULT_JVMARGS}


if [[ ! -f $JAR ]]; then
    echo "Missing heroic jar: $JAR"
    exit 1
fi

if [[ ! -f $JVMARGS ]]; then
    echo "Missing jvmargs: $JVMARGS"
    exit 1
fi

JAVA_OPTS=$(grep -v '^\s*#' $JVMARGS)

exec env CLASSPATH="$JAR" java $JAVA_OPTS com.spotify.heroic.Main "$@"
